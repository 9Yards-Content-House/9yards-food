import{j as e}from"./vendor-ui-DQFCUi79.js";import{d as Q,r as x,L as A}from"./vendor-react-B7BoA3Rs.js";import{d as T,b as _,F as q,c as R,M as V,p as J}from"./MobileNav-ChPk0N7S.js";import{c as $,u as ee,X as se,a as l}from"./index-BYjMsFBS.js";import{f as i,g as H,a as re,b as te}from"./order-D1cqG1BQ.js";import{T as ae}from"./truck-BHImNAVG.js";import{C as ne}from"./chevron-right-BtiL6dRQ.js";import{M as oe}from"./minus-B28LXxk8.js";import{P as L}from"./plus-DB2mJX3M.js";import{T as le}from"./trash-2-DsxrhI2z.js";import{C as de}from"./circle-check-big-Bhm5uWDj.js";import{M as ie}from"./message-circle-DAFV-qRh.js";import{L as ce}from"./loader-circle-BnFHeASf.js";import{C as me}from"./credit-card-6rT_bHuM.js";import{C as ue}from"./clock-Brk2Rl_5.js";import"./vendor-utils--BulIq_u.js";import"./vendor-query-BnlKTJhf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=$("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=$("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),pe="FLWPUBK_TEST-2cbeceb8352891cbcd28a983ce8d57ac-X";function U(){const r=new Date().getHours();return r>=12&&r<14||r>=18&&r<20}function he(u){const r=T.find(d=>d.name===u)?.estimatedTime||"30-45 mins";if(U()){const d=r.match(/(\d+)-(\d+)/);if(d)return`${parseInt(d[1])+15}-${parseInt(d[2])+15} mins`}return r}function ge(u,r,d){const c=u.toUpperCase().trim(),a=J[c];return a?a.minOrder&&r<a.minOrder?{valid:!1,discount:0,discountType:"fixed",message:`Minimum order of ${i(a.minOrder)} required`}:c==="FREESHIP"?{valid:!0,discount:d,discountType:"free_delivery",message:"Free delivery applied!",code:c}:a.type==="percentage"?{valid:!0,discount:Math.round(r*(a.discount/100)),discountType:"percentage",message:`${a.discount}% discount applied!`,code:c}:{valid:!0,discount:a.discount,discountType:"fixed",message:`${i(a.discount)} discount applied!`,code:c}:{valid:!1,discount:0,discountType:"fixed",message:"Invalid promo code"}}function _e(){const u=Q(),{state:r,removeItem:d,updateQuantity:c,clearCart:a,cartTotal:n,setUserPreferences:j,addOrderToHistory:W}=ee(),[m,Z]=x.useState(""),[v,D]=x.useState(""),[t,I]=x.useState(null),[N,w]=x.useState(!1),[k,Y]=x.useState(""),f=T.find(s=>s.name===m)?.fee||0,P=5e4,g=n>=P,b=x.useMemo(()=>g||t?.valid&&t.discountType==="free_delivery"?0:f,[g,t,f]),y=x.useMemo(()=>t?.valid?t.discountType==="free_delivery"?f:t.discount:0,[t,f]),p=n+b-(t?.discountType!=="free_delivery"?y:0),C=he(m),S=U(),B=()=>{if(!v.trim()){l.error("Please enter a promo code");return}const s=ge(v,n,f);I(s),s.valid?l.success(s.message):l.error(s.message)},G=()=>{D(""),I(null),l.info("Promo code removed")},E=()=>r.userPreferences.name?.trim()?r.userPreferences.phone?.trim()?m?r.userPreferences.address?.trim()?!0:(l.error("Please enter your delivery address"),!1):(l.error("Please select a delivery zone"),!1):(l.error("Please enter your phone number"),!1):(l.error("Please enter your name"),!1),F=(s,o)=>({orderId:s,items:r.items,customerInfo:{...r.userPreferences,location:m,specialInstructions:k},subtotal:n,deliveryFee:b,discount:y,total:p,paymentMethod:o,estimatedDelivery:C,orderDate:new Date().toISOString()}),M=(s,o)=>{const h={orderId:s,orderDate:new Date().toISOString(),items:r.items,deliveryLocation:m,deliveryFee:b,subtotal:n,discount:y,total:p,paymentMethod:o,status:"pending"};W(h)},z=()=>{if(!E())return;const s=H(),o=re(s,r.items,{...r.userPreferences,location:m,specialInstructions:k},n,b,p,"Pay on Delivery");M(s,"whatsapp");const h=F(s,"whatsapp");window.open(te(o),"_blank"),a(),u("/order-confirmation",{state:h})},K=()=>{if(E())if(typeof window.FlutterwaveCheckout!="function"){const s=document.createElement("script");s.src="https://checkout.flutterwave.com/v3.js",s.async=!0,s.onload=()=>O(),document.body.appendChild(s)}else O()},O=()=>{w(!0);const s=H(),o={public_key:pe,tx_ref:s,amount:p,currency:"UGX",payment_options:"card,mobilemoneyuganda,ussd",customer:{email:`${r.userPreferences.phone.replace(/\D/g,"")}@9yards.co.ug`,phone_number:r.userPreferences.phone,name:r.userPreferences.name},customizations:{title:"9Yards Food",description:`Order ${s}`,logo:"https://food.9yards.co.ug/logo.png"},callback:h=>{if(w(!1),h.status==="successful"){M(s,"online");const X=F(s,"online");a(),u("/order-confirmation",{state:X}),l.success("Payment successful!")}else l.error("Payment failed. Please try again.")},onclose:()=>{w(!1)}};window.FlutterwaveCheckout(o)};return r.items.length===0?e.jsxs("div",{className:"min-h-screen bg-background pb-20 lg:pb-0",children:[e.jsx(_,{}),e.jsx("main",{className:"pt-16 md:pt-20",children:e.jsx("div",{className:"container-custom section-padding text-center",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"w-24 h-24 bg-muted rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(ae,{className:"w-12 h-12 text-muted-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"Your Cart is Empty"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Looks like you haven't added any items yet. Explore our menu and build your perfect meal!"}),e.jsxs(A,{to:"/menu",className:"btn-secondary inline-flex items-center gap-2",children:["Browse Menu",e.jsx(ne,{className:"w-5 h-5"})]})]})})}),e.jsx(q,{}),e.jsx(R,{})]}):e.jsxs("div",{className:"min-h-screen bg-background pb-20 lg:pb-0",children:[e.jsx(_,{}),e.jsx("main",{className:"pt-16 md:pt-20",children:e.jsxs("div",{className:"container-custom section-padding",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-foreground mb-8",children:["Your Cart (",r.items.length," items)"]}),S&&e.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-xl flex items-start gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Peak Hours"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:["High demand right now! Delivery may take ",C,"."]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.items.map(s=>e.jsx("div",{className:"card-premium p-4 md:p-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 bg-muted rounded-xl flex-shrink-0 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"ðŸ½ï¸"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"font-bold text-foreground mb-1",children:[s.mainDishes.join(" + ")," Combo"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[s.sauce?.name," (",s.sauce?.preparation,","," ",s.sauce?.size,") + ",s.sideDish]}),s.extras.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+ ",s.extras.map(o=>`${o.name} (${o.quantity})`).join(", ")]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("span",{className:"text-secondary font-bold",children:i(s.totalPrice*s.quantity)}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-muted rounded-lg p-1",children:[e.jsx("button",{onClick:()=>c(s.id,Math.max(1,s.quantity-1)),className:"w-10 h-10 rounded-md flex items-center justify-center hover:bg-background transition-colors","aria-label":"Decrease quantity",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center font-medium","aria-label":`Quantity: ${s.quantity}`,children:s.quantity}),e.jsx("button",{onClick:()=>c(s.id,s.quantity+1),className:"w-10 h-10 rounded-md flex items-center justify-center hover:bg-background transition-colors","aria-label":"Increase quantity",children:e.jsx(L,{className:"w-4 h-4"})})]}),e.jsx("button",{onClick:()=>d(s.id),className:"w-11 h-11 rounded-lg bg-destructive/10 text-destructive flex items-center justify-center hover:bg-destructive/20 transition-colors","aria-label":"Remove item",children:e.jsx(le,{className:"w-4 h-4"})})]})]})]})]})},s.id)),e.jsxs(A,{to:"/menu",className:"inline-flex items-center gap-2 text-secondary font-medium hover:underline",children:[e.jsx(L,{className:"w-4 h-4"}),"Add More Items"]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card-premium p-6 sticky top-28",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground mb-6",children:"Order Summary"}),!g&&e.jsxs("div",{className:"mb-6 p-4 bg-secondary/10 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(xe,{className:"w-4 h-4 text-secondary"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Free Delivery Progress"})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden mb-2",children:e.jsx("div",{className:"h-full bg-secondary rounded-full transition-all",style:{width:`${Math.min(100,n/P*100)}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Spend"," ",e.jsx("span",{className:"font-semibold text-secondary",children:i(P-n)})," ","more for free delivery!"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground mb-2 block",children:[e.jsx(V,{className:"w-4 h-4 inline mr-1"}),"Delivery Zone *"]}),e.jsxs("select",{value:m,onChange:s=>Z(s.target.value),className:"w-full p-3 rounded-lg border border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-secondary",children:[e.jsx("option",{value:"",children:"Select your area"}),T.map(s=>e.jsxs("option",{value:s.name,children:[s.name," - ",i(s.fee)," (",s.estimatedTime,")"]},s.name))]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Your Name *"}),e.jsx("input",{type:"text",value:r.userPreferences.name,onChange:s=>j({name:s.target.value}),placeholder:"Enter your name",className:"w-full p-3 rounded-lg border border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Phone Number *"}),e.jsx("input",{type:"tel",value:r.userPreferences.phone,onChange:s=>j({phone:s.target.value}),placeholder:"+256 700 000 000",className:"w-full p-3 rounded-lg border border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Delivery Address *"}),e.jsx("textarea",{value:r.userPreferences.address,onChange:s=>j({address:s.target.value}),placeholder:"Enter delivery address",rows:2,className:"w-full p-3 rounded-lg border border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-secondary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Special Instructions (Optional)"}),e.jsx("textarea",{value:k,onChange:s=>Y(s.target.value),placeholder:"Gate code, landmarks, special requests...",rows:2,className:"w-full p-3 rounded-lg border border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-secondary resize-none"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Promo Code"}),t?.valid?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:t.code})]}),e.jsx("button",{onClick:G,className:"text-green-600 hover:text-green-800","aria-label":"Remove promo code",children:e.jsx(se,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:v,onChange:s=>D(s.target.value.toUpperCase()),placeholder:"Enter code",className:"flex-1 p-3 rounded-lg border border-border bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-secondary"}),e.jsx("button",{onClick:B,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors",children:"Apply"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Try: FIRST10, SAVE5K, or FREESHIP"})]}),e.jsxs("div",{className:"space-y-3 mb-6 pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{className:"text-foreground",children:i(n)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery Fee"}),e.jsx("span",{className:"text-foreground",children:g||t?.valid&&t.discountType==="free_delivery"?e.jsx("span",{className:"text-secondary font-medium",children:"FREE"}):m?i(f):"Select zone"})]}),t?.valid&&t.discountType!=="free_delivery"&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-green-600",children:"Discount"}),e.jsxs("span",{className:"text-green-600",children:["-",i(y)]})]}),e.jsxs("div",{className:"flex justify-between pt-3 border-t border-border",children:[e.jsx("span",{className:"font-bold text-foreground",children:"Total"}),e.jsx("span",{className:"font-bold text-xl text-secondary",children:i(p)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:z,disabled:N,className:"w-full btn-secondary flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx(ie,{className:"w-5 h-5"}),"Order via WhatsApp"]}),e.jsx("button",{onClick:K,disabled:N,className:"w-full btn-outline flex items-center justify-center gap-2 disabled:opacity-50",children:N?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-5 h-5"}),"Pay Online"]})})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center justify-center gap-1",children:[e.jsx(ue,{className:"w-3 h-3"}),"Estimated delivery: ",C]}),S&&e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"(Peak hours - may take longer)"})]})]})})]})]})}),e.jsx(q,{}),e.jsx(R,{})]})}export{_e as default};
